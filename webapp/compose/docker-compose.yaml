version: '2'
services:

  db:
    build:
      context: ${WORKSPACE}/Dockerfiles
      dockerfile: PG-Dockerfile
    environment:
      POSTGRES_PASSWORD: ${PG_PASSWORD}
    container_name: mypostgres

  web:
    build:
      context: ${WORKSPACE}/Dockerfiles
      dockerfile: TOMCAT-Dockerfile
    depends_on: 
      - db
    links:
      - db:postgres
    volumes:
      - ${WORKSPACE}/artifacts/webdemo.war:/usr/local/tomcat/webapps/webdemo.war
    ports:
      - "8080"

  
